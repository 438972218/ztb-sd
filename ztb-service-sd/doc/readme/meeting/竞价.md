## 竞价

### 前端

#### 内部端

##### 竞价监控器

- ~~开始时间，结束时间不对	【高】~~

- ~~已持续时间=timeOfDuration（从websocket拿）	【高】~~

- ~~剩余时间拿countdown（从websocket拿）	【高】~~

- ~~起始价格去掉个	【高】~~

- ~~延时间隔加分钟	【高】~~

- ~~已持续时间，剩余时间如果没有值，显示00:00:00	【高】~~

- ~~去掉剩余时间四个字	【高】~~

- ~~供应商排名：总排名放在最上面，下面分品类显示排名	【高】~~

- ~~操作：（具体逻辑看原型）	【中】~~
  
  - 暂停：
  
  ```apl
  (```)
    GET方法：/paidSheet/pause/{sheetId}
  (```)
  ```
  
  - 恢复：
  
  ```apl
  (```)
  GET方法：/paidSheet/recover/{sheetId}
  (```)
  ```
  
  重新竞价：
  
  ```apl
  (```)
  POST方法：/paidSheet/anew
  {
    "id": 0,
    "offerEndTime": 0,
    "offerStartTime": 0
  }
  (```)
  ```
  
- 终止：

  ```apl
  (```)
    GET方法：
  (```)
  ```

- 供应商排名：【中】

  - ~~总排名缺少接口~~
  - ~~单物品排名调用接口显示重复~~
  - ~~出价人改成供应商标识~~

- ~~供应商总排名逻辑加过滤：只计算所有物品都出过价的供应商参与排名~~

- 剩余时间一栏时间显示逻辑：未到开始时间显示开始时间倒计时

- 剩余时间一栏背景色：进行中是绿色，待竞价状态显示黄色，其他显示红色

- 供应商排名，在竞价截止前，显示供应商标识，截止状态是可以看到真实供应商名称

- 授权功能

- 刷新页面后需要走接口拿暂停时间

- ~~暂停/恢复/重新竞价/终止竞价会导致登录失效，跳转到登录页面~~

- 供应商在线状态不对

- 供应商出价图表：每个供应商显示一条线，每条线颜色区分，鼠标悬浮到点上显示具体金额。供应商标识要显示出来

- ~~摘要开始结束时间不对 【高】~~

- 重新竞价的开始结束时间没有更新成功 【高】

- 供应商按名次排名显示

- 供应商状态  没有实时显示状态



##### 竞价列表

- ~~创建人下拉显示：用户名-姓名~~

- ~~从模板创建   	【高】~~

  ```apl
  (```)
   GET方法：/paidSheet/template
  (```)
  ```

  

- ~~监控器图标更换	【高】~~

- ~~创建人显示用户姓名	【中】~~

- ~~附件上传人返回用户姓名	【中】~~

- ~~横向滚动条	【中】~~

- ~~竞价开始结束带时间~~

- 



##### 竞价单详情

- ~~竞价开始时间，结束时间：控件改成可选时间	【高】~~
- ~~品类加修改和删除功能	【高】~~
- ~~明细加修改和删除功能	【高】~~
- ~~增加附件时加选择供应商是否可见	【高】~~
- ~~右上角增加监控器按钮，链接进入竞价监控器	【高】~~
- ~~新增品类必填项：品类名称，最小出价配置，最小出价幅度，单位，数量，~~~
- ~~新增明细弹层标题改成新增明细	【高】~~
- ~~新增明细：品类名称改成细项	【高】~~
- ~~新增明细弹层必填：细项，单位，数量	【高】~~
- ~~编辑附件标题改成编辑附件	【高】~~
- 供应商tab页：
  - ~~不能添加重复的供应商	【高】~~
  - ~~点击新增供应商时要把上次选择的下拉清空	【高】~~
  - ~~选择供应商后联动展示城市，联系人，电话，邮箱	【高】~~
- ~~创建页面，项目下拉过滤掉模板不显示，加入参：type="official"~~
- ~~发布	【高】~~
- ~~新增明细：单位放在数量下面，数量判断不能输如数字	【中】~~
- ~~新增品类：单位必填，测试时不必填也能过	【中】~~
- ~~竞价结束时间比竞价开始时间大~~
- ~~讨论功能	【中】~~
- ~~加广播列表	【中】~~
- ~~供应商|附件  提示请求方式错误~~
- ~~创建人改成用户姓名~~
- 到结束时间后状态未改成截止
- 出价结构影响起始价格逻辑：
  - ~~出价结构为总额+起始价格规则为统一，则品项列表显示统一起始价格，不显示区分起始价格~~
  - 出价结构为总额+起始价格规则为区分，则品项列表不显示统一起始价格，显示区分起始价格，链接弹层，显示供应商名称列表，列表中可维护各自的起始价格
  - ~~出价结构为多项产品，起始价格只能为统一，品项列表显示统一起始价格，不显示区分起始价格~~
  - ~~出价结构为总额+起始价格规则为不设定，则品项列表统一起始价格和区分起始价格都不显示  ？？【经讨论不支持】~~
- 如果触发价格不为空则最小出价幅度必填	【高】
- 新增品类报错
- 新增竞价保存后直接显示该竞价单详情
- 竞价项目名称：改为竞价名称
- 是否测试竞价：默认为否
- 供应商竞价监控器：显示总价？单项排名？
- 保存时，自动显示详情维护页面
- 起始价格规则字段：显示在抬头里
- 起始价格和触发价格：没有设为必输
- 当竞价为反向时，校验维护的"触发价格"应该是小于等于"起始价格"



#### 供应商端

##### 竞价监控器

- ~~加单位和数量；	【高】~~
- ~~品类增加最小出价，最小出价配置，币种	【高】~~
- ~~物品改成品类	【高】~~
- ~~竞价信息四个字去掉	【高】~~
- ~~起始价格等去掉个	【高】~~
- ~~按品类折叠	【高】~~
- ~~排名右边加触发价格,逻辑是：取出价的字段“是否有效” 的最新一条，红色圆圈代表未触发，绿色圆圈代表已触发	【高】~~
- ~~顶部样式：剩余时间放左边，去掉剩余时间四个字。右边上下结构摆放，上面放广播内容，下面放竞价名称内容，去掉竞价名称四个【高】~~
- 多项产品加单价，输入单价后，最后出价从后端返回的结果中获取，如果无效则不更新，如果有效则更新最后出价
  - 提交给后端的出价计算公式是：最后出价=单价*数量	【中】
  - ~~如果是多项物品，则placeholder显示请输入单价	【中】~~
  - ~~如果是总额，则placeholder无显示，始终是灰掉	【中】~~
- ~~出价按钮必须竞价单状态为进行中才能点击，否则为灰掉	【中】~~
- ~~竞价状态是截止则不创建websocket连接	【中】【取消】~~
- ~~剩余时间默认是00:00:00   小时:分钟:秒	【中】~~
- ~~排名：目前没有拿到	【中】~~
- ~~供应商端总排名逻辑加过滤：所有物品都出过价的供应商才有显示总排名~~
- ~~出价时间不对~~
- ~~总额有明细和总额无明细，多项产品都是出单价~~
- ~~触发价格字段显示逻辑：未达到时显示未达到；达到时显示已触发；	【需确认触发价格为空时的显示逻辑】~~
- 剩余时间一栏背景色：待竞价状态显示黄色，未到开始时间显示开始时间倒计时。（与内部端一致）	【中】
- 全局要加问号图标，点击问号图标给提示该字段的解释说明，前端有个文件统一配置提示内容	【中】
- 供应商看不到讨论内容
- 广播的内容没有显示出来
- 出价结构为总额，起始价格规则为区分，则取竞价单中供应商对应的起始价格
- ~~把加载中显示在物品行~~
- 离开页面后在线状态未显示离线





##### 竞价列表

- ~~竞价开始结束时间带时间	【高】~~
- ~~竞价监控器图标要换掉	【中】~~
- ~~去掉创建人，创建时间	【高】~~
- ~~查询条件加竞价编号	【高】~~
- ~~列表加买方企业	【中】~~
- 项目代码放在项目名称前面
- 从模板创建没有成功
- 复制功能无效
- 

##### 竞价详情

- ~~创建讨论~~

- ~~加广播列表~~

  ```apl
  (```)
   GET方法：/bulletinBoard
  (```)
  ```

- 品项明细，供应商不能修改删除

- 附件不能上传成功

- 授权查询



### 后端

- 业务调邮件发送功能	【中】
- 附件打开加水印	【中】
- ~~竞价编号：字母+年月日+三位数字。如：COM+210914+001	【高】~~
- ~~供应商端竞价列表只显示发布之后所有的状态的竞价单（包含待竞价，进行中，已暂停，截止，待授权，已中标状态的竞价单）	【中】~~
- ~~创建人返回用户姓名~~
- ~~附件上传人返回用户姓名~~



